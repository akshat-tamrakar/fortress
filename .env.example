# ============================================================================
# Fortress User Management Service - Environment Configuration
# ============================================================================
# This is a template file. Copy this to .env and fill in your actual values.
# DO NOT commit .env to version control!
#
# Setup Instructions:
# 1. Copy this file: cp .env.example .env
# 2. Replace all dummy values with your actual credentials
# 3. Ensure .env is in .gitignore (already configured)
# ============================================================================


# ============================================================================
# Django Configuration
# ============================================================================

# Secret key for Django - Generate new key for production!
# Use: python -c 'from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())'
SECRET_KEY=django-insecure-REPLACE_WITH_YOUR_SECRET_KEY_IN_PRODUCTION

# Debug mode - Set to False in production
DEBUG=True

# Allowed hosts - Comma-separated list (e.g., localhost,127.0.0.1,yourdomain.com)
ALLOWED_HOSTS=localhost,127.0.0.1


# ============================================================================
# AWS Configuration
# ============================================================================

# AWS Region where your resources are deployed
AWS_REGION=us-east-1

# AWS Credentials (for service-to-service communication)
# These are used by CognitoClient and AVPClient for AWS SDK calls
# In production, use IAM roles instead of hardcoded credentials
AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY

# Optional: AWS Session Token (for temporary credentials)
# AWS_SESSION_TOKEN=


# ============================================================================
# AWS Cognito Configuration - User Pool
# ============================================================================

# Main User Pool for end users (customers/regular users)
# Format: us-east-1_XXXXXXXXX
COGNITO_USER_POOL_ID=us-east-1_example123

# User Pool App Client ID
COGNITO_CLIENT_ID=1234567890abcdefghijklmnop

# User Pool App Client Secret (if your app client has a secret)
# Leave empty if using a public client (no secret)
COGNITO_CLIENT_SECRET=1a2b3c4d5e6f7g8h9i0j1k2l3m4n5o6p7q8r9s0t1u2v3w4x5y6z


# ============================================================================
# AWS Cognito Configuration - Admin Pool (Optional)
# ============================================================================

# Separate Admin User Pool for administrative users (if applicable)
# If you use the same pool for both users and admins, use the same values as above
# Format: us-east-1_XXXXXXXXX
COGNITO_ADMIN_USER_POOL_ID=us-east-1_adminpool1

# Admin Pool App Client ID
COGNITO_ADMIN_CLIENT_ID=admin1234567890abcdefgh


# ============================================================================
# Redis Configuration
# ============================================================================

# Redis connection URL (recommended - overrides individual settings below)
# Format: redis://[username:password@]host:port/db
# Example with password: redis://:mypassword@localhost:6379/1
REDIS_URL=redis://127.0.0.1:6379/1

# Individual Redis settings (used if REDIS_URL is not set)
REDIS_HOST=127.0.0.1
REDIS_PORT=6379
REDIS_DB=1

# REQUIRED IN PRODUCTION: Redis password (strong random password)
# Generate with: openssl rand -base64 32
# REDIS_PASSWORD=your_redis_password_here


# ============================================================================
# Cache TTL Configuration (in seconds)
# ============================================================================

# User status cache TTL (enabled/disabled status)
# Shorter TTL = more real-time status updates but more cache misses
CACHE_TTL_USER_STATUS=30

# Authorization decision cache TTL
# Balance between performance and authorization freshness
CACHE_TTL_AUTHORIZATION=60

# JWT public keys (JWKS) cache TTL
# These change infrequently, so longer TTL is acceptable
CACHE_TTL_JWKS=86400


# ============================================================================
# Token Expiry Configuration (in seconds)
# ============================================================================

# Access token expiry time
# Default: 900 seconds (15 minutes)
# Shorter expiry = more secure but more frequent token refreshes
ACCESS_TOKEN_EXPIRY=900

# Refresh token expiry time
# Default: 604800 seconds (7 days)
# Users must re-authenticate after this period
REFRESH_TOKEN_EXPIRY=604800


# ============================================================================
# Amazon Verified Permissions (AVP) Configuration
# ============================================================================

# AVP Policy Store ID for authorization decisions
# Format: PolicyStoreId123456
AVP_POLICY_STORE_ID=PSExamplePolicyStore123456


# ============================================================================
# Service URLs
# ============================================================================

# Authorization Service URL (if using external authorization service)
# For local development, typically points to localhost
AUTHORIZATION_SERVICE_URL=http://localhost:8000/v1/authorization


# ============================================================================
# Optional: Database Configuration
# ============================================================================
# Currently using SQLite (default). For production, consider PostgreSQL or MySQL.
#
# Example PostgreSQL configuration:
# DATABASE_URL=postgresql://username:password@localhost:5432/fortress_db
#
# Example MySQL configuration:
# DATABASE_URL=mysql://username:password@localhost:3306/fortress_db


# ============================================================================
# Optional: Logging Configuration
# ============================================================================

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Log format: json or text
# LOG_FORMAT=json


# ============================================================================
# Rate Limiting Configuration
# ============================================================================

# Enable or disable rate limiting
# Set to false for development/testing if needed
RATE_LIMIT_ENABLED=true

# Maximum number of requests allowed per time window
# Default: 100 requests
RATE_LIMIT_REQUESTS=100

# Time window for rate limiting (in seconds)
# Default: 60 seconds (1 minute)
RATE_LIMIT_WINDOW=60


# ============================================================================
# CORS Configuration (for frontend applications)
# ============================================================================

# Enable or disable CORS
CORS_ENABLED=true

# Allowed origins for CORS (comma-separated, no spaces)
# Development: Include localhost with different ports
# Production: Only include your actual domain(s)
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8000

# Allow credentials (cookies, authorization headers) in CORS requests
CORS_ALLOW_CREDENTIALS=true


# ============================================================================
# Security Headers Configuration
# ============================================================================

# Content Security Policy (CSP)
# Defines which resources can be loaded to prevent XSS attacks
# Adjust based on your frontend requirements
CONTENT_SECURITY_POLICY=default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self'

# HTTP Strict Transport Security (HSTS)
# Forces HTTPS connections - IMPORTANT: Only enable in production with HTTPS!
HSTS_ENABLED=true

# HSTS max age in seconds (how long browsers should remember to use HTTPS)
# Default: 31536000 (1 year)
HSTS_MAX_AGE=31536000

# Include subdomains in HSTS policy
HSTS_INCLUDE_SUBDOMAINS=true

# HSTS preload (submit to browser preload list)
# Only enable if you're sure and have submitted to hstspreload.org
HSTS_PRELOAD=false


# ============================================================================
# Optional: Email Configuration (for Cognito email notifications)
# ============================================================================
# If you want to use custom email sending instead of Cognito defaults
#
# EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
# EMAIL_HOST=smtp.gmail.com
# EMAIL_PORT=587
# EMAIL_USE_TLS=True
# EMAIL_HOST_USER=your-email@example.com
# EMAIL_HOST_PASSWORD=your-app-specific-password


# ============================================================================
# Development vs Production Notes
# ============================================================================
#
# DEVELOPMENT:
# - DEBUG=True
# - Use local Redis (redis://127.0.0.1:6379/1)
# - Use dummy/test AWS credentials or IAM role on EC2
# - Shorter cache TTLs for testing
# - RATE_LIMIT_ENABLED=false (optional, for easier testing)
# - CORS_ALLOWED_ORIGINS includes localhost with various ports
# - HSTS_ENABLED=false (no HTTPS in local development)
#
# PRODUCTION:
# - DEBUG=False
# - Use ElastiCache or production Redis cluster
# - Use IAM roles instead of hardcoded AWS credentials
# - Set appropriate ALLOWED_HOSTS
# - Generate strong SECRET_KEY
# - Use longer cache TTLs for performance
# - Enable HTTPS only
# - Review and adjust token expiry times
# - RATE_LIMIT_ENABLED=true with appropriate limits
# - CORS_ALLOWED_ORIGINS only includes production domain(s)
# - HSTS_ENABLED=true with appropriate settings
# - Review and adjust Content Security Policy for your needs
#
# ============================================================================
